```python
class Solution:
    def subarraysDivByK(self, nums: List[int], k: int) -> int:
        s = accumulate(nums, initial=0)
        d = defaultdict(int)

        for x in s:
            d[x % k] += 1
        
        cnt = list(d.values())
        return int(sum(c * (c - 1) / 2 for c in cnt))
```

**离线统计**的方法，子数组和可被整除 -> 前缀和之差可被整除 -> 统计模 k 的值相等的前缀和

如果一个 key 下有 n 个前缀和，那么它们能够组成多少的子数组？答案是 $C_n^2 = \frac{n(n - 1)}{2}$

```python
class Solution:
    def subarraysDivByK(self, nums: List[int], k: int) -> int:
        s = accumulate(nums, initial=0)
        d = defaultdict(int)
        ans = 0

        for x in s:
	        ans += d[x % k]
            d[x % k] += 1
        
        return ans
```

**在线更新**的方法，每次**先查表、再更新**。等价于数学组合

#数组 #哈希表 #前缀和
